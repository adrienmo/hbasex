language: elixir
elixir:
  - 1.2.5
otp_release:
  - 18.2.1

sudo: required

services:
  - docker

before_install:
  - docker pull adrienmo/hbase
  - mkdir data
  - id=$(docker run --name=hbase-docker -h hbase-docker -d -v $PWD/data:/data adrienmo/hbase)
  - docker cp migration.sh $id:/migration.sh
  - docker exec -i -t $id /bin/bash /migration.sh
  - ip=$(docker inspect --format '{{ .NetworkSettings.IPAddress }}' $id)
  - sudo echo "$ip hbase-docker" >> /etc/hosts
  - echo "hbase server running on $ip"

script:
  - mix test
